unit UnitExercicio2;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, Grids, Buttons;

type
  TFormExe2 = class(TForm)
    procedure FormShow(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

  //exer 2
  Tdados = class(TStringGrid)
    private
      procedure ButtonSair(Sender:TObject);
      procedure ButtonExportar(Sender:TObject);
      procedure ButtonImportar(Sender:TObject);
      //function verifica(pal:string):integer;

    public
      BtnImportar, BtnExportar, BtnSair: TSpeedButton;
      constructor create(dados: TComponent);
  end;



var
  FormExe2: TFormExe2;
  objeto:TDados;
  logico:TextFile; //definição nome logico
  open: TOpenDialog;

implementation

{$R *.dfm}



//Importar
procedure Tdados.ButtonImportar(Sender:TObject);
begin
 open:=TOpenDialog.Create(FormExe2);

end;

    

//button exportar
procedure Tdados.ButtonExportar(Sender:TObject);
var lin: integer;
begin
  AssignFile(logico,'C:\Users\shirl\OneDrive\Documentos\Borland Studio Projects\atividade II\questao2.csv');
  rewrite(logico);  //criar/abrir arquivo

  for lin:=0 to RowCount - 1 do
    writeln(logico, cells[0,lin]+ ';' + cells[1,lin]);
  closefile(logico);
end;

//contrutores
constructor TDados.create(dados: TComponent);
var col, lin: integer;
begin
  inherited create(dados);
  //grid
  FixedCols:=0;
  FixedRows:=1;
  ColCount:=2;   //Qtde de coluna
  RowCount:=2;   //Qtde de linha
  DefaultColWidth:=120;
  DefaultRowHeight:=20;
  Width:=250;  //largura coluna
  Height:=150;
  left:=10;
  top:=10;
  Cells[0,0]:='Palavras';
  Cells[1,0]:='Total';

  //Button  - BtnImportar, BtnExportar, BtnSair: TSpeedButton;
  //Exportar
  BtnImportar:=TSpeedButton.create(FormExe2);
  BtnImportar.Parent:=FormExe2;
  BtnImportar.Left:=280;
  BtnImportar.Top:=10;
  BtnImportar.width:= 121;
  BtnImportar.Height:=41;
  BtnImportar.Caption:= 'Importar';
  BtnImportar.OnClick:= ButtonImportar;

  //Exportar
  BtnExportar:=TSpeedButton.create(FormExe2);
  BtnExportar.Parent:=FormExe2;
  BtnExportar.Left:=280;
  BtnExportar.Top:=65;
  BtnExportar.width:= 121;
  BtnExportar.Height:=41;
  BtnExportar.Caption:= 'Exportar';
  BtnExportar.OnClick:= ButtonExportar;

  //sair
  BtnSair:=TSpeedButton.create(FormExe2);
  BtnSair.Parent:=FormExe2;
  BtnSair.Left:=280;
  BtnSair.Top:=120;
  BtnSair.width:= 121;
  BtnSair.Height:=40;
  BtnSair.Caption:= 'Sair';
  BtnSair.OnClick:= ButtonSair;

end;

//button Sair
procedure Tdados.ButtonSair(Sender:TObject);
begin
  FormExe2.close;;
end;


procedure TFormExe2.FormShow(Sender: TObject);
begin
  objeto:=TDados.create(FormExe2);
  objeto.Parent:=FormExe2;
end;

end.
